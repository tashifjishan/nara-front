<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        console.log("hello")
        const variants = {
    "edges": [
        {
            "node": {
                "id": "gid://shopify/ProductVariant/46128122265855",
                "title": "Black / S / Silk",
                "quantityAvailable": 15,
                "price": {
                    "amount": "800.0",
                    "currencyCode": "INR"
                },
                "selectedOptions": [
                    {
                        "name": "Color",
                        "value": "Black"
                    },
                    {
                        "name": "Size",
                        "value": "S"
                    },
                    {
                        "name": "Fabric",
                        "value": "Silk"
                    }
                ],
                "image": {
                    "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/black_2_acdd72e6-87ee-4aba-8556-df214be5db59.jpg?v=1726305268"
                }
            }
        },
        {
            "node": {
                "id": "gid://shopify/ProductVariant/46134517825791",
                "title": "Black / S / Cotton",
                "quantityAvailable": 0,
                "price": {
                    "amount": "800.0",
                    "currencyCode": "INR"
                },
                "selectedOptions": [
                    {
                        "name": "Color",
                        "value": "Black"
                    },
                    {
                        "name": "Size",
                        "value": "S"
                    },
                    {
                        "name": "Fabric",
                        "value": "Cotton"
                    }
                ],
                "image": {
                    "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/1.webp?v=1726064188"
                }
            }
        },
        {
            "node": {
                "id": "gid://shopify/ProductVariant/46128122364159",
                "title": "Black / M / Silk",
                "quantityAvailable": 30,
                "price": {
                    "amount": "500.0",
                    "currencyCode": "INR"
                },
                "selectedOptions": [
                    {
                        "name": "Color",
                        "value": "Black"
                    },
                    {
                        "name": "Size",
                        "value": "M"
                    },
                    {
                        "name": "Fabric",
                        "value": "Silk"
                    }
                ],
                "image": {
                    "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/1.webp?v=1726064188"
                }
            }
        },
        {
            "node": {
                "id": "gid://shopify/ProductVariant/46128122298623",
                "title": "Black / L / Silk",
                "quantityAvailable": 85,
                "price": {
                    "amount": "10000.0",
                    "currencyCode": "INR"
                },
                "selectedOptions": [
                    {
                        "name": "Color",
                        "value": "Black"
                    },
                    {
                        "name": "Size",
                        "value": "L"
                    },
                    {
                        "name": "Fabric",
                        "value": "Silk"
                    }
                ],
                "image": {
                    "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/Screenshot_2024-03-06_021616.png?v=1726114595"
                }
            }
        },
        {
            "node": {
                "id": "gid://shopify/ProductVariant/46134517891327",
                "title": "Black / L / Cotton",
                "quantityAvailable": 15,
                "price": {
                    "amount": "800.0",
                    "currencyCode": "INR"
                },
                "selectedOptions": [
                    {
                        "name": "Color",
                        "value": "Black"
                    },
                    {
                        "name": "Size",
                        "value": "L"
                    },
                    {
                        "name": "Fabric",
                        "value": "Cotton"
                    }
                ],
                "image": {
                    "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/1.webp?v=1726064188"
                }
            }
        },
        {
            "node": {
                "id": "gid://shopify/ProductVariant/46134491283711",
                "title": "Gray / M / Silk",
                "quantityAvailable": 0,
                "price": {
                    "amount": "800.0",
                    "currencyCode": "INR"
                },
                "selectedOptions": [
                    {
                        "name": "Color",
                        "value": "Gray"
                    },
                    {
                        "name": "Size",
                        "value": "M"
                    },
                    {
                        "name": "Fabric",
                        "value": "Silk"
                    }
                ],
                "image": {
                    "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/1.webp?v=1726064188"
                }
            }
        },
        {
            "node": {
                "id": "gid://shopify/ProductVariant/46134517924095",
                "title": "Gray / M / Cotton",
                "quantityAvailable": 15,
                "price": {
                    "amount": "800.0",
                    "currencyCode": "INR"
                },
                "selectedOptions": [
                    {
                        "name": "Color",
                        "value": "Gray"
                    },
                    {
                        "name": "Size",
                        "value": "M"
                    },
                    {
                        "name": "Fabric",
                        "value": "Cotton"
                    }
                ],
                "image": {
                    "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/1.webp?v=1726064188"
                }
            }
        },
        {
            "node": {
                "id": "gid://shopify/ProductVariant/46134491316479",
                "title": "Gray / L / Silk",
                "quantityAvailable": 0,
                "price": {
                    "amount": "800.0",
                    "currencyCode": "INR"
                },
                "selectedOptions": [
                    {
                        "name": "Color",
                        "value": "Gray"
                    },
                    {
                        "name": "Size",
                        "value": "L"
                    },
                    {
                        "name": "Fabric",
                        "value": "Silk"
                    }
                ],
                "image": {
                    "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/1.webp?v=1726064188"
                }
            }
        },
        {
            "node": {
                "id": "gid://shopify/ProductVariant/46134517956863",
                "title": "Gray / L / Cotton",
                "quantityAvailable": 15,
                "price": {
                    "amount": "800.0",
                    "currencyCode": "INR"
                },
                "selectedOptions": [
                    {
                        "name": "Color",
                        "value": "Gray"
                    },
                    {
                        "name": "Size",
                        "value": "L"
                    },
                    {
                        "name": "Fabric",
                        "value": "Cotton"
                    }
                ],
                "image": {
                    "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/1.webp?v=1726064188"
                }
            }
        }
    ]
};

let availableVariants = variants.edges;
console.log("all variants: ", availableVariants);
let variantsInStock = availableVariants.filter(el=>parseInt(el.node.quantityAvailable)>0);


console.log("Variants that are in stock: ", variantsInStock);

const lowestPricedVariant = variantsInStock.reduce((prev,cur)=>{
    return +cur.node.price.amount < +prev.node.price.amount ? cur : prev;
});



console.log("Lowest Priced Variant: ", lowestPricedVariant)
let options = [
    {name: "Color", values: ["Black", "Gray"]},
    {name: "Fabric", values: ["Silk", "Cotton"]},
    {name: "Size", values: ["S", "M", "L"]},
    
];

const availableOptions = options.map(el=>el.name);
console.log("Available options", availableOptions);

let mappedVariants = options.map(option=>{
    return options.map(el=>{
        if(el.name===option.name) return el.name;
        return el.name + " available";
    })
});



console.log("mapped variants", mappedVariants)

// filter variants by various options:
const dummy = variantsInStock.filter(el=> el.node.selectedOptions.find(el=>el.name==="Size").value==="M");
console.log("available black variants: ", dummy);

//Size M ke liye

const colorsAvailable = dummy.map(el=>el.node.selectedOptions.find(el=>el.name==="Color").value);
console.log(colorsAvailable);

const FabricAvailable = dummy.map(el=>el.node.selectedOptions.find(el=>el.name==="Fabric").value);
console.log(FabricAvailable);


function getRemainingOptionsValues(availableOptions, filterOption, filterOptionValue) {
    // Remove the option to filter (e.g., "Color") from the list of options
    const remainingOptions = availableOptions.filter(option => option !== filterOption);

    // Get all variants where the filter option (e.g., "Color") has the specified value (e.g., "Gray")

    const matchingVariants = variantsInStock.filter(variant =>
        variant.node.selectedOptions.find(option => option.name === filterOption).value === filterOptionValue
    );

    console.log("Variants in stock: ", variantsInStock);
    console.log("Matching Variants: ", matchingVariants);

    const optionValues = {};

    remainingOptions.forEach(option => {
        // Extract unique values for each remaining option (e.g., all available sizes for the color "Gray")
        const values = matchingVariants.map(variant =>
            variant.node.selectedOptions.find(opt => opt.name === option).value
        );

        
        optionValues[option] = [...new Set(values)]; // Remove duplicates
    });

    console.log("logging option values: ", optionValues);
}

getRemainingOptionsValues(availableOptions, "Color", "Black");
// getRemainingOptionsValues(availableOptions, "Size", "L");

/*
[
    {
        "node": {
            "id": "gid://shopify/ProductVariant/46128122265855",
            "title": "Black / S / Silk",
            "quantityAvailable": 15,
            "price": {
                "amount": "800.0",
                "currencyCode": "INR"
            },
            "selectedOptions": [
                {
                    "name": "Color",
                    "value": "Black"
                },
                {
                    "name": "Size",
                    "value": "S"
                },
                {
                    "name": "Fabric",
                    "value": "Silk"
                }
            ],
            "image": {
                "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/black_2_acdd72e6-87ee-4aba-8556-df214be5db59.jpg?v=1726305268"
            }
        }
    },
    {
        "node": {
            "id": "gid://shopify/ProductVariant/46128122364159",
            "title": "Black / M / Silk",
            "quantityAvailable": 30,
            "price": {
                "amount": "500.0",
                "currencyCode": "INR"
            },
            "selectedOptions": [
                {
                    "name": "Color",
                    "value": "Black"
                },
                {
                    "name": "Size",
                    "value": "M"
                },
                {
                    "name": "Fabric",
                    "value": "Silk"
                }
            ],
            "image": {
                "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/1.webp?v=1726064188"
            }
        }
    },
    {
        "node": {
            "id": "gid://shopify/ProductVariant/46128122298623",
            "title": "Black / L / Silk",
            "quantityAvailable": 85,
            "price": {
                "amount": "10000.0",
                "currencyCode": "INR"
            },
            "selectedOptions": [
                {
                    "name": "Color",
                    "value": "Black"
                },
                {
                    "name": "Size",
                    "value": "L"
                },
                {
                    "name": "Fabric",
                    "value": "Silk"
                }
            ],
            "image": {
                "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/Screenshot_2024-03-06_021616.png?v=1726114595"
            }
        }
    },
    {
        "node": {
            "id": "gid://shopify/ProductVariant/46134517891327",
            "title": "Black / L / Cotton",
            "quantityAvailable": 15,
            "price": {
                "amount": "800.0",
                "currencyCode": "INR"
            },
            "selectedOptions": [
                {
                    "name": "Color",
                    "value": "Black"
                },
                {
                    "name": "Size",
                    "value": "L"
                },
                {
                    "name": "Fabric",
                    "value": "Cotton"
                }
            ],
            "image": {
                "src": "https://cdn.shopify.com/s/files/1/0713/4265/3695/files/1.webp?v=1726064188"
            }
        }
    }
]
*/




    </script>
</body>
</html>